"use strict";angular.module("leseulsteve.angular-mongoose",[]),angular.module("leseulsteve.angular-mongoose").factory("Hooks",["$q",function(a){function b(){this.hooks={pre:{},post:{}},this.allowedOperations={pre:["caching","create","save","remove"],post:["find","create","save","remove"]};var a=this;_.forEach(this.allowedOperations.pre,function(b){a.hooks.pre[b]=[]}),_.forEach(this.allowedOperations.post,function(b){a.hooks.post[b]=[]})}return b.prototype.register=function(a,b,c){if(_.isUndefined(this.hooks[a][b]))throw new Error('Operation "'+b+'" n\'est pas prise en charge par la fonction "'+a+'"');this.hooks[a][b].push(c)},b.prototype.process=function(b,c,d){var e=[];return _.forEach(this.hooks[b][c],function(b){var c=a.defer();e.push(c.promise);var f=function(){c.resolve(d)};b.apply(d,[f])}),a.all(e).then(function(){return d})},b}]),angular.module("leseulsteve.angular-mongoose").factory("RemoteStore",["$http",function(a){function b(a){this.apiUrl=a}return b.prototype.find=function(b){var c={params:b?b:void 0};return a.get(this.apiUrl,c).then(function(a){return a.data})},b.prototype.findById=function(b){return a.get(this.apiUrl+"/"+b).then(function(a){return a.data})},b.prototype.create=function(b){return a.post(this.apiUrl,b).then(function(a){return a.data})},b.prototype.update=function(b){return a.put(this.apiUrl+"/"+b._id,b).then(function(a){return a.data})},b.prototype.remove=function(b){return a["delete"](this.apiUrl+"/"+b._id)},b}]),angular.module("leseulsteve.angular-mongoose").factory("Schema",["$q","$http","Hooks","RemoteStore",function(a,b,c,d){var e=function(b){function e(a){this.getApiUrl=function(){return b},_.assign(this,a)}var f=new c,g=new d(b);return e.create=function(a){var b=new e(a);return f.process("pre","create",b).then(function(a){return g.create(a).then(function(a){return f.process("post","find",new e(a)).then(function(a){return f.process("post","create",a)})})})},e.find=function(b){return g.find(b).then(function(b){var c=[],d=[];return _.forEach(b,function(a){d.push(f.process("post","find",new e(a)).then(function(a){c.push(a)}))}),a.all(d).then(function(){return c})})},e.findOne=function(a){return e.find(a).then(function(a){return a.length>0?a[0]:null})},e.findById=function(a){return g.findById(a).then(function(a){return f.process("post","find",new e(a))})},e.pre=function(a,b){f.register("pre",a,b)},e.post=function(a,b){f.register("post",a,b)},e.prototype.save=function(){return _.isUndefined(this._id)?f.process("pre","create",this).then(function(a){return g.create(a).then(function(a){return f.process("post","find",new e(a)).then(function(a){return f.process("post","create",a)})})}):f.process("pre","save",this).then(function(a){return g.update(a).then(function(a){return f.process("post","save",new e(a)).then(function(a){return f.process("post","find",a)})})})},e.prototype.remove=function(){return f.process("pre","remove",this).then(function(a){return g.remove(a).then(function(){return f.process("post","remove",a)})})},e};return e}]);
//# sourceMappingURL=angular-mongoose.min.js.map