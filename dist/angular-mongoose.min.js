"use strict";angular.module("angular-mongoose",[]),angular.module("angular-mongoose").factory("Hooks",["$q",function(a){function b(){this.hooks=[]}return b.prototype.register=function(a,b){if("function"!=typeof b)throw new Error("No a function");this.hooks[a]=b},b.prototype.process=function(b,c){var d=a.defer(),e=this.hooks[b],f=function(){d.resolve(c)};return e?e.apply(c,[f]):f(),d.promise},b}]),angular.module("angular-mongoose").factory("RemoteStore",["$http",function(a){function b(a){this.apiUrl=a}return b.prototype.find=function(){return a.get(this.apiUrl).then(function(a){return a.data})},b.prototype.findById=function(b){return a.get(this.apiUrl+"/"+b).then(function(a){return a.data})},b.prototype.create=function(b){return a.post(this.apiUrl,b).then(function(a){return a.data})},b.prototype.update=function(b){return a.put(this.apiUrl+"/"+b._id,b).then(function(a){return a.data})},b.prototype.remove=function(b){return a["delete"](this.apiUrl+"/"+b._id)},b}]),angular.module("angular-mongoose").factory("Schema",["$q","$http","Hooks","RemoteStore",function(a,b,c,d){var e=function(a){function b(b){this.getApiUrl=function(){return a},_.assign(this,b)}var e=new c,f=new d(a);return b.create=function(a){var c=new b(a);return e.process("pre-create",c).then(function(a){return f.create(a).then(function(a){return e.process("post-create",new b(a.data))})})},b.find=function(){return f.find().then(function(a){var c=[];return _.forEach(a,function(a){c.push(new b(a))}),c})},b.findById=function(a){return f.findById(a).then(function(a){return new b(a)})},b.pre=function(a,b){e.register("pre-"+a,b)},b.post=function(a,b){e.register("post-"+a,b)},b.prototype.save=function(){return e.process("pre-update",this).then(function(a){return f.update(a).then(function(a){new b(a)})["catch"](function(c){return 401===c.code?e.process("pre-create",a).then(function(a){return f.create(a).then(function(a){return e.process("post-create",new b(a.data))})}):void 0})})},b.prototype.remove=function(){return e.process("pre-delete",this).then(function(a){return f.remove(a).then(function(a){return e.process("post-delete",a)})})},b};return e}]);
//# sourceMappingURL=angular-mongoose.min.js.map